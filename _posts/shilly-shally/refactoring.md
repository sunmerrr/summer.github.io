---
title: "약 1000줄에 가까운 코드 300줄로 줄인 후기"
excerpt: "백엔드 개발자가 짠 프론트엔드 코드 리팩토링 후기"

categories:
  - Developer
tags:
  - [Software, web, Developer, Software Developer]

toc: true
toc_sticky: true
 
date: 2023-11-17
last_modified_at: 2023-11-18
---

내가 지금 회사에 존재하기 약 1년전, 백엔드인 그는 프론트엔드 코드를 짜달라는 지시를 받게 되는데...
![제가요 짤](https://github.com/sunmerrr/sunmerrr.github.io/assets/65106740/1de3dd23-4a8b-4307-96c7-d4cd1207a5ec)

## 리팩토링의 필요성(그냥 다시 짜세요)
지금 회사에 레거시 코드가 종종 보이고, 어느 부분은 이러저런식으로 고쳐도 좋겠다 싶은 구간들이 조금씩 있다. 그런 부분들은 어느 회사에가도 있을법한 그런 소소한 부분들이고, 유지보수하는데 문제가 전혀 없는 정도이다.    
그런데 결코 건드릴 수 없을정도로 어지러운(진짜임) 컴포넌트가 하나 있었다. 약 1000줄정도에 비슷한 변수과 함수명만 3~4개 정도돼서 유지보수 하기도 너무 어려웠다. 기능도 잘 동작하고 크게 문제가 없는(없다고 믿고 싶은) 곳이라 따로 건드릴 생각이 없었는데.. 마침 이번에 고객사에서 해당 부분에 문제가 있는 것 같다고 연락이 왔다. 그래서 찬찬히 살펴보는데 생각보다 문제가 컸다. 다른 고객사가 말없이 사용해준것이 감사할만큼..    
암튼 자의반 타의반(타의 90%)으로 무덤까지 가지고 가고 싶었던 아름다운 코드를 리팩토링을 하게 되었다.    
  ![image](https://github.com/sunmerrr/sunmerrr.github.io/assets/65106740/e192b4cb-13b9-49a5-9da4-b1377a6b126a)


## 아묻따 리팩토링
사실 옆에서 해당 부분이 어떻게 개발되었는지 지켜본 선임개발자가 차라리 처음부터 다시 짜라고 했으나, 초큼의 귀찮음 + 스스로에게 도전과제 부여 같은 느낌으로 그냥 리팩토링을 했다. 이걸 계기로 어지러운 코드 리팩토링 경험도 가져가고 콘텐츠도 뽑아볼 수 있을 것  같다는 생각도 들었다.    
그런데, 리팩토링 하기 전에 유지보수 할 때부터 컴포넌트 내부를 아무리 쳐다봐도 이해가 되지 않았다. 어느 함수가 무슨 역할을 하는지는 함수 내부를 뜯어봐도 헷갈렸다. 여기저기 흩어져있는 변수 선언과 state, ref도 헷갈리게 하는데 한 몫 했다.

#### 리팩토링 기준
이렇게 저렇게 해보면서 리팩토링을 진행했는데 의식의 흐름대로 리팩토링을 할 수는 없는 코드라서 상당히 고민하고 진행했다. 3일 정도 같은 코드를 쳐다보니까 뭐 때문에 잘 안 읽히는지, 어느 부분을 개선하면 좋을지 조금 보였다. 위에서 가볍게 이야기했지만 내가 생각했을때 여기 코드에서 부족하다고 생각한 점을 적어봤다.      
  ![푸우 짤](https://github.com/sunmerrr/sunmerrr.github.io/assets/65106740/5576137e-13b5-4e44-a3cb-61ddefeff0f8)     
- 응집도      
  코드를 살펴보면서 가장 어려웠던게 너무 분산되어있는 데이터들이었다. 상단에 있는 함수를 중간에서 갖다 쓰고 중간 어딘가에 필요한 데이터를 정의해두고.. 컴포넌트가 분명 세 덩이로 있는 것 같기는 한데 뭐가 필요하고 필요하지 않은지를 파악하는 것도 쉽지 않았다.
- 중복성     
  변수명이랑 함수명은 그렇다쳐도 비슷한 함수만 세 개정도 되는 것 같았다. 결국 아주 미묘하게 다른 무언가를 바꿔주기위해서 기존 함수와 다른 새로운 함수를 만든 것 같은데 이름도 비슷하고 내용물도 어디가 다른지 찾아내기 어려워서 이떻게하면 깔끔하게 만들 수 있을지 고민했던 것 같다.

## 나 어지러워..

![리팩토링 중](https://github.com/sunmerrr/sunmerrr.github.io/assets/65106740/471853a7-dd67-4ee6-9a27-967022d9525c)
    고요속의 (주석) 외침 이랄까..

아무튼 리팩토링은 했는데.. 해놓고 보니 완벽한 리팩토링이란 존재하지 않는것은 아닌가 싶다.